# Order Service (L0)

üßæ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –Ω–∞ Go, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–∫–∞–∑—ã –∏–∑ Kafka, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ PostgreSQL, –∫—ç—à–∏—Ä—É–µ—Ç –≤ –ø–∞–º—è—Ç–∏ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ `order_uid`.

---

## üß© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **Go (Golang)** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
- **Kafka** ‚Äî –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π (—á–µ—Ä–µ–∑ `cp-kafka`)
- **Kafka REST Proxy** ‚Äî –¥–ª—è —É–¥–æ–±–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Postman / Thunder Client
- **In-memory cache (Go map)** ‚Äî –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- **HTML-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** ‚Äî –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ ID

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞


**make all**

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:


**docker compose up --build -d**

-  –ü—Ä–∏ —ç—Ç–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è:

- PostgreSQL —Å –ë–î ordersdb

- Kafka + Zookeeper

- Kafka REST Proxy (–ø–æ—Ä—Ç 8082)

- Go-—Å–µ—Ä–≤–∏—Å (–ø–æ—Ä—Ç 8081)

---
## ‚öôÔ∏è –ú–∏–≥—Ä–∞—Ü–∏–∏

–í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ PostgreSQL —á–µ—Ä–µ–∑ —Ñ–∞–π–ª:


init.sql

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏:

make init-db
---
## üß™ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤ Docker
–†–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
![Alt text](image-3.png)

–ù–∞ –≤–∏–¥–µ–æ —è –ø–æ–∫–∞–∂—É:

- make up ‚Äî –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö

- make logs ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, —á—Ç–æ Go-—Å–µ—Ä–≤–∏—Å –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ Kafka –∏ –ë–î

- –û—Ç–ø—Ä–∞–≤–∫—É JSON –∑–∞–∫–∞–∑–∞ —á–µ—Ä–µ–∑ Kafka (–∏–∑ model.json)

- –ü–æ—è–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥–∞—Ö (Order ... saved and cached)

- –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —á–µ—Ä–µ–∑:

- HTTP API: curl http://localhost:8081/order/<order_uid>

- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ –∞–¥—Ä–µ—Å—É http://localhost:8081 

---
## üì® –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞ –≤ Kafka
Thunder Client / Postman
URL: http://localhost:8082/topics/orders_topic

Method: POST

Headers:
Content-Type: application/vnd.kafka.json.v2+json

Accept: application/vnd.kafka.v2+json
![Alt text](image-4.png)
Body ‚Üí raw ‚Üí JSON:




{
  "records": [
    {
      "value": { /* —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ model.json */ }
    }
  ]
}
![Alt text](image.png)
---
### üåê HTTP API
GET /order/{order_uid} ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑ –ø–æ ID (–∏–∑ –∫—ç—à–∞ –∏–ª–∏ –ë–î)


–ü—Ä–∏–º–µ—Ä:
![Alt text](image-1.png)
---
### üß† –ö—ç—à
–í—Å–µ –∑–∞–∫–∞–∑—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ map[string]Order

–ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫—ç—à –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ –±–∞–∑—ã

–ö—ç—à —É—Å–∫–æ—Ä—è–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –ø–æ order_uid

---



## üß™ Makefile –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞         | –û–ø–∏—Å–∞–Ω–∏–µ                              |
|-----------------|---------------------------------------|
| `make all`      | –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤         |
| `make up`       | –ó–∞–ø—É—Å–∫ Docker Compose                 |
| `make down`     | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ volume'–æ–≤        |
| `make restart`  | –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π              |
| `make logs`     | –õ–æ–≥–∏ Go-—Å–µ—Ä–≤–∏—Å–∞                       |
| `make psql`     | –í—Ö–æ–¥ –≤ PostgreSQL                     |
| `make kafka-send` | Kafka CLI-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏–π    |
| `make create-topic` | –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ Kafka-—Ç–æ–ø–∏–∫–∞       |
| `make init-db`  | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü –≤ –ë–î             |


## üñ•Ô∏è –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
![Alt text](image-2.png)

http://localhost:8081
–í–≤–µ–¥–∏—Ç–µ order_uid ‚Üí –ø–æ–ª—É—á–∏—Ç–µ JSON-–æ—Ç–≤–µ—Ç.